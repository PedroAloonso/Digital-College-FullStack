<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 19</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>JavaScript</h1>
    <h2>DOM</h2>
    <h2>Objetos</h2>
    <br>
    <!--O meu-->
    <h1 
    onclick= fetchCatImage()
    style="cursor: pointer; user-select: none;">
    Mudar Gato</h1>
    <img src="" id="Cats" alt="Gato" style="max-width: 350px;">
    <!--Classe-->
    <br>
    <select id="cidadesSelect">
        <option value="defaut"> Selecione uma cidade</option>
    </select>
    <br>
    <div class="header" id="myDIV">
        <h2>Minha lista</h2>
        <input type="text" name="" id="myInput" placeholder="Title...">
        <span onclick=novoItem() class="addBtn">Adicionar</span>
        <span onclick=removePrimeiroItem()>Remover primeiro </span>
    </div>
    <ul id="myUL"></ul>
    <br>
    <h1>Tarefa Demo</h1>
    <select id="estados"></select>
    <select id="municipios"></select>

    <script src="script.js"></script>
    <script src="scriptAPI.js"></script>
    <script>
        // Array de estados
        const statesArray = [
            {"sigla": "AC", "nome": "Acre"},
            {"sigla": "AL", "nome": "Alagoas"},
            {"sigla": "AP", "nome": "Amapá"},
            {"sigla": "AM", "nome": "Amazonas"},
            {"sigla": "BA", "nome": "Bahia"},
            {"sigla": "CE", "nome": "Ceará"},
            {"sigla": "DF", "nome": "Distrito Federal"},
            {"sigla": "ES", "nome": "Espírito Santo"},
            {"sigla": "GO", "nome": "Goiás"},
            {"sigla": "MA", "nome": "Maranhão"},
            {"sigla": "MT", "nome": "Mato Grosso"},
            {"sigla": "MS", "nome": "Mato Grosso do Sul"},
            {"sigla": "MG", "nome": "Minas Gerais"},
            {"sigla": "PA", "nome": "Pará"},
            {"sigla": "PB", "nome": "Paraíba"},
            {"sigla": "PR", "nome": "Paraná"},
            {"sigla": "PE", "nome": "Pernambuco"},
            {"sigla": "PI", "nome": "Piauí"},
            {"sigla": "RJ", "nome": "Rio de Janeiro"},
            {"sigla": "RN", "nome": "Rio Grande do Norte"},
            {"sigla": "RS", "nome": "Rio Grande do Sul"},
            {"sigla": "RO", "nome": "Rondônia"},
            {"sigla": "RR", "nome": "Roraima"},
            {"sigla": "SC", "nome": "Santa Catarina"},
            {"sigla": "SP", "nome": "São Paulo"},
            {"sigla": "SE", "nome": "Sergipe"},
            {"sigla": "TO", "nome": "Tocantins"}
        ];

        // Seletores do DOM
        const estados = document.getElementById("estados");
        const municipios = document.getElementById("municipios");

        // Função para criar e adicionar elementos de cidade
        function criarEAddElemento(cidade) {
            const cidadeOption = document.createElement("option");
            cidadeOption.textContent = cidade.nome;
            municipios.appendChild(cidadeOption);
        }

        // Função para buscar cidades com base no estado
        async function buscarCidadesCE(estado) {
            municipios.innerHTML = ''; // Limpa a lista de municípios
            const url = `https://servicodados.ibge.gov.br/api/v1/localidades/estados/${estado.toLowerCase()}/municipios`;
            try {
                const resposta = await fetch(url);
                const json = await resposta.json();
                json.forEach(criarEAddElemento);
            } catch (error) {
                alert("Não foi possível carregar as cidades");
                console.log(error);
            }
        }

        // Adiciona opções de estados ao dropdown e configura o evento de mudança
        statesArray.forEach(e => {
            const estadoOption = document.createElement("option");
            estadoOption.textContent = `${e.sigla} - ${e.nome}`;
            estadoOption.value = e.sigla;
            if (e.sigla === "CE") {
                estadoOption.selected = true;
                buscarCidadesCE(e.sigla); // Carrega cidades para o estado CE por padrão
            }
            estados.appendChild(estadoOption);
        });

        // Adiciona o evento de mudança ao dropdown de estados
        estados.addEventListener("change", (e) => {
            buscarCidadesCE(e.target.value);
        });

    </script>
</body>
</html>